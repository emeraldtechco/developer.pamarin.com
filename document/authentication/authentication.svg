<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1187px" height="1754px" viewBox="-0.5 -0.5 1187 1754" content="&lt;mxfile modified=&quot;2019-08-07T13:04:00.547Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36&quot; etag=&quot;gIO4OGx1TIEczSk-EIed&quot; version=&quot;11.1.2&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;17bl3SH3Tnu5EkGAU0ez&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 148 41 L 148 1738.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 148 1743.88 L 144.5 1736.88 L 148 1738.63 L 151.5 1736.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 40 L 550 1738.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 550 1743.88 L 546.5 1736.88 L 550 1738.63 L 553.5 1736.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="490" y="0" width="120" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(500.5,13.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 99px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">www.pamarin.com</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">www.pamarin.com</text></switch></g><rect x="88" y="1" width="120" height="40" fill="#f5f5f5" stroke="#666666" pointer-events="none"/><g transform="translate(111.5,14.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">User/Browser</div></div></foreignObject><text x="37" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">User/Browser</text></switch></g><path d="M 1010 40 L 1010 1738.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1010 1743.88 L 1006.5 1736.88 L 1010 1738.63 L 1013.5 1736.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="940" y="0" width="140" height="40" fill="#fff2cc" stroke="#d6b656" pointer-events="none"/><g transform="translate(955.5,13.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="109" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 110px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">authen.pamarin.com</div></div></foreignObject><text x="55" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">authen.pamarin.com</text></switch></g><path d="M 150 82 L 543.63 82" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 548.88 82 L 541.88 85.5 L 543.63 82 L 541.88 78.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 756 L 1003.63 756" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 756 L 1001.88 759.5 L 1003.63 756 L 1001.88 752.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(573.5,69.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="272" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 273px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">2. นำ <font color="#0000ff">access_token</font> มา build http post <br />ส่งไปตรวจสอบที่ <font color="#0000ff">authen.pamarin/com/oauth/session</font></div></div></foreignObject><text x="136" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(239.5,43.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">1. เข้าใช้งาน <br />cookie : <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(564.5,728.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="347" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 348px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">8. redirect ไปที่  <font color="#0000ff"><span>authen.pamarin/com</span>/oauth/authorize</font> (ต่อจาก 7.2)</div></div></foreignObject><text x="174" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">8. redirect ไปที่  &lt;font color="#0000ff"&gt;&lt;span&gt;authen.pamarin/com&lt;/span&gt;/oauth/authorize&lt;/font&gt; (ต่อจาก 7.2)</text></switch></g><g transform="translate(565.5,769.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="337" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 338px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">querystring : <font color="#0000ff">response_type</font>, <font color="#0000ff">client_id</font>, <font color="#0000ff">redirect_uri</font>, <font color="#0000ff">scope</font>, <font color="#0000ff">state</font></div></div></foreignObject><text x="169" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1024.5,133.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 154px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">3. verify <font color="#0000ff">access_token </font>&amp;<font color="#0000ff"> user_session </font>in database</div></div></foreignObject><text x="77" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1010 836 L 156.37 836" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 836 L 158.12 832.5 L 156.37 836 L 158.12 839.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(561.5,848.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="247" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 247px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">10.1 ถ้า verify request ไม่ผ่าน จะได้ error กลับไปทาง redirect_uri?error=xxx</font></div></div></foreignObject><text x="124" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1008 916 L 154.37 916" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 149.12 916 L 156.12 912.5 L 154.37 916 L 156.12 919.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(562.5,924.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="267" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 268px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">10.2 ถ้า verify ผ่าน <br />จะได้หน้า <font color="#0000ff"><span>authen.pamarin/com</span>/oauth/signin</font> กลับไป</div></div></foreignObject><text x="134" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(22.5,1699.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="97" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 98px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">วนกลับไปข้อ 1 ใหม่</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">วนกลับไปข้อ 1 ใหม่</text></switch></g><path d="M 148 997 L 1003.63 997" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 997 L 1001.88 1000.5 L 1003.63 997 L 1001.88 993.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(7.5,954.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">11. กรอก <br />username / password<br />(ต่อจาก 10.2)</div></div></foreignObject><text x="58" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(275.5,968.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">12. กดปุ่ม login / เข้าสู่ระบบ</div></div></foreignObject><text x="69" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">12. กดปุ่ม login / เข้าสู่ระบบ</text></switch></g><g transform="translate(1034.5,1010.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">13. ตรวจสอบ <br /><font color="#0000ff">username</font> / <font color="#0000ff">password</font></div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1066 L 155.37 1066" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 150.12 1066 L 157.12 1062.5 L 155.37 1066 L 157.12 1069.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(569.5,1095.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="288" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 288px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">14.2 ถ้า valid username / password <br />ระบบจะ generate authorization_code กลับไปทาง <font color="#0000ff">redirect_uri?code=xxx&amp;state=yyy</font></div></div></foreignObject><text x="144" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1145 L 155.37 1145" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 150.12 1145 L 157.12 1141.5 L 155.37 1145 L 157.12 1148.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(594.5,1030.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="261" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 262px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">14.1 ถ้า invalid username or password <br />จะแสดงข้อความว่า username / password ไม่ถูกต้อง</font></div></div></foreignObject><text x="131" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 150 1218 L 543.63 1218" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 548.88 1218 L 541.88 1221.5 L 543.63 1218 L 541.88 1214.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(574.5,1544.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="248" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 249px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">19.2.1. จัดเก็บ <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font> ไว้<br />(set-cookie) <span>รวมทั้งเช็คสิทธิ์ตามข้อมูล </span><br /><font color="#0000ff">user_session</font><span> ที่ระบบ authen ส่งมาให้</span></div></div></foreignObject><text x="124" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(575.5,1178.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="323" height="112" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 324px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">16. อ่าน parameter <font color="#0000ff">code=xxx</font> + verify <font color="#0000ff">state=yyy</font> <br />ว่าผ่านหรือไม่ เพื่อป้องกัน CSRF<br /><br />จากนั้น build http post ด้วย parameters <br /><font color="#0000ff">client_id</font>, <font color="#0000ff">client_secret</font>, <font color="#0000ff">code</font>, <font color="#0000ff">grant_type=authorization_code<br /></font><span style="text-align: center"><br />ส่ง request ไปขอ </span><font color="#0000ff" style="text-align: center">access_token</font><span style="text-align: center"> + ข้อมูล </span><font color="#0000ff" style="text-align: center">user_session</font><span style="text-align: center"> </span><br style="text-align: center" /><span style="text-align: center">ที่ </span><font color="#0000ff" style="text-align: center">authen.pamarin.com/oauth/token</font><font color="#0000ff"><br /></font></div></div></foreignObject><text x="162" y="62" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1305 L 1003.63 1305" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 1305 L 1001.88 1308.5 L 1003.63 1305 L 1001.88 1301.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1014.5,1337.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 170px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">18. verify request<br />ตรวจสอบ <font color="#0000ff">code</font>, <font color="#0000ff">client_id</font> / <font color="#0000ff">client_scret</font></div></div></foreignObject><text x="85" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1386 L 556.37 1386" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 551.12 1386 L 558.12 1382.5 L 556.37 1386 L 558.12 1389.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(653.5,1477.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="248" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 250px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">19.2 กรณีที่ verify request ผ่าน<br />ระบบจะ generate <font color="#0000ff">access_token</font>, <font color="#0000ff">refresh_token</font> <br />ข้อมูล <font color="#0000ff">user_session</font> กลับไปให้ในรูปแบบ json</div></div></foreignObject><text x="124" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1466 L 556.37 1466" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 551.12 1466 L 558.12 1462.5 L 556.37 1466 L 558.12 1469.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(692.5,1397.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 172px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">19.1 กรณีที่ verify request ไม่ผ่าน<br />จะได้ error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="85" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(245.5,1188.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="209" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 210px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">15. browser send <font color="#0000ff">code=xxx&amp;state=yyy</font> <br />ไปยัง www.pamarin.com (ต่อจาก 14.2)</div></div></foreignObject><text x="105" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1654 L 156.37 1654" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1654 L 158.12 1650.5 L 156.37 1654 L 158.12 1657.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1023.5,776.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="55" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 154px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">9. verify request<br />ตรวจสอบ <font color="#0000ff">response_type</font>, <font color="#0000ff">client_id</font>, <font color="#0000ff">redirect_uri</font>,<br /><font color="#0000ff">scope</font></div></div></foreignObject><text x="77" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 113 L 1002.63 113" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1007.88 113 L 1000.88 116.5 L 1002.63 113 L 1000.88 109.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1010 182 L 558.37 182" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 553.12 182 L 560.12 178.5 L 558.37 182 L 560.12 185.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(570.5,371.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="363" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 364px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">5. นำ <font color="#0000ff">refresh_token</font> มา build http post (ต่อจาก 4.2)<br />เพื่อขอ <font color="#0000ff">access_token </font>ใหม่<br />ส่งไปที่ <font color="#0000ff">authen.pamarin.com/oauth/token (</font><font color="#0000ff">grant_type=refresh_token)</font></div></div></foreignObject><text x="182" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(563.5,202.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="194" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 195px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1.1 เช็คสิทธิ์ (authorities) ตามข้อมูล <br /><font color="#0000ff">user_session</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="97" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 216.5 L 156.37 216.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 216.5 L 158.12 213 L 156.37 216.5 L 158.12 220 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(217.5,176.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">4.1.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 280 L 156.37 280" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 280 L 158.12 276.5 L 156.37 280 L 158.12 283.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(254.5,242.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">4.1.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><path d="M 1010 337 L 558.37 337" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 553.12 337 L 560.12 333.5 L 558.37 337 L 560.12 340.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(673.5,295.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="188" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 189px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">4.2 ถ้า access_token invalid<br />จะ return error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="94" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 435.5 L 1002.63 435.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1007.88 435.5 L 1000.88 439 L 1002.63 435.5 L 1000.88 432 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(659.5,143.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="245" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 246px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1 ถ้า <font color="#0000ff">access_token</font> valid<br />จะ return <font color="#0000ff">user_session</font> กลับมาให้ในรูปแบบ json</div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1028.5,463.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="55" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 154px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">6. verify request<br />ตรวจสอบ <font color="#0000ff">refresh_token, client_id, client_secret<br /><br /></font></div></div></foreignObject><text x="77" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1011.5 518 L 559.87 518" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 554.62 518 L 561.62 514.5 L 559.87 518 L 561.62 521.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(570.5,459.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="348" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 349px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1 ถ้า <font color="#0000ff">refresh_token</font> valid<br />จะ return <font color="#0000ff">access_token, refresh_token </font>ใหม่ + ข้อมูล<font color="#0000ff"> user_session</font> <br />กลับไปในรูปแบบ json</div></div></foreignObject><text x="174" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(563.5,535.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="241" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 241px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1.1 จัดเก็บ <font color="#0000ff">access_token</font> + <font color="#0000ff">refresh_token</font> ใหม่ (set-cookie) รวมทั้งเช็คสิทธิ์ตามข้อมูล <br /><font color="#0000ff">user_session</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="121" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 560 L 156.37 560" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 560 L 158.12 556.5 L 156.37 560 L 158.12 563.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(256.5,1401.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">19.1.1 return error กลับไปหา user</font></div></div></foreignObject><text x="88" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;font color="#ff0000"&gt;19.1.1 return error กลับไปหา user&lt;/font&gt;</text></switch></g><path d="M 550 623.5 L 156.37 623.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 623.5 L 158.12 620 L 156.37 623.5 L 158.12 627 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(254.5,586.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">7.1.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><path d="M 1009 677.5 L 557.37 677.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 552.12 677.5 L 559.12 674 L 557.37 677.5 L 559.12 681 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(573.5,635.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="188" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 189px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">7.2 ถ้า refresh_token invalid<br />จะ return error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="94" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1386.5 L 156.37 1386.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1386.5 L 158.12 1383 L 156.37 1386.5 L 158.12 1390 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(227.5,530.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">7.1.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1579 L 156.37 1579" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1579 L 158.12 1575.5 L 156.37 1579 L 158.12 1582.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(227.5,1549.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">19.2.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(264.5,1616.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">19.2.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">19.2.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><rect x="1028" y="93" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1058.5,102.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="77" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/session</font></div></div></foreignObject><text x="39" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="420.5" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1064.5,430.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="66" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 67px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/token</font></div></div></foreignObject><text x="33" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="734" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1054.5,743.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="86" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 87px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/authorize</font></div></div></foreignObject><text x="43" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="1295.5" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1064.5,1305.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="66" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 67px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/token</font></div></div></foreignObject><text x="33" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1026.5" y="967" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1061.5,976.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="68" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 69px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/signin</font></div></div></foreignObject><text x="34" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>