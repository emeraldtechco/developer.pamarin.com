<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1324px" height="1896px" viewBox="-0.5 -0.5 1324 1896" content="&lt;mxfile modified=&quot;2019-08-09T10:12:15.967Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&quot; etag=&quot;1fXpSfFuoKvzbGU91hu0&quot; version=&quot;11.1.4&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;17bl3SH3Tnu5EkGAU0ez&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 148 183 L 148 1880.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 148 1885.88 L 144.5 1878.88 L 148 1880.63 L 151.5 1878.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 182 L 550 1880.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 550 1885.88 L 546.5 1878.88 L 550 1880.63 L 553.5 1878.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="490" y="142" width="120" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(500.5,155.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 99px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">www.pamarin.com</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">www.pamarin.com</text></switch></g><rect x="88" y="143" width="120" height="40" fill="#f5f5f5" stroke="#666666" pointer-events="none"/><g transform="translate(111.5,156.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">User/Browser</div></div></foreignObject><text x="37" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">User/Browser</text></switch></g><path d="M 1010 182 L 1010 1880.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1010 1885.88 L 1006.5 1878.88 L 1010 1880.63 L 1013.5 1878.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="940" y="142" width="140" height="40" fill="#fff2cc" stroke="#d6b656" pointer-events="none"/><g transform="translate(955.5,155.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="109" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 110px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">authen.pamarin.com</div></div></foreignObject><text x="55" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">authen.pamarin.com</text></switch></g><path d="M 150 224 L 543.63 224" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 548.88 224 L 541.88 227.5 L 543.63 224 L 541.88 220.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 898 L 1003.63 898" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 898 L 1001.88 901.5 L 1003.63 898 L 1001.88 894.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(573.5,211.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">2. นำ <font color="#0000ff">access_token</font> มา build http post <br />ส่งไปตรวจสอบที่ <font color="#0000ff">/oauth/session</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(239.5,185.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">1. เข้าใช้งาน / ร้องขอ resource<br />cookie : <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(564.5,870.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="237" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 238px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">8. redirect ไปที่  <font color="#0000ff">/oauth/authorize</font> (ต่อจาก 7.2)</div></div></foreignObject><text x="119" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">8. redirect ไปที่  &lt;font color="#0000ff"&gt;/oauth/authorize&lt;/font&gt; (ต่อจาก 7.2)</text></switch></g><g transform="translate(565.5,904.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="337" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 338px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">querystring : <font color="#0000ff">response_type=code</font>, <font color="#0000ff">client_id</font>, <font color="#0000ff">redirect_uri</font>, <font color="#0000ff">scope</font><br />random <font color="#0000ff">state=yyy </font>จัดเก็บไว้พร้อมแนบไปด้วย</div></div></foreignObject><text x="169" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1024.5,275.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 180px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">3. verify <font color="#0000ff">access_token </font>&amp;<font color="#0000ff"> user_session </font>in data store (redis)</div></div></foreignObject><text x="90" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1010 977 L 156.37 977" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 977 L 158.12 973.5 L 156.37 977 L 158.12 980.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(561.5,989.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="247" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 247px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">10.1 ถ้า verify request ไม่ผ่าน จะได้ error กลับไปทาง redirect_uri?error=xxx</font></div></div></foreignObject><text x="124" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1008 1145 L 154.37 1145" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 149.12 1145 L 156.12 1141.5 L 154.37 1145 L 156.12 1148.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(562.5,1157.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="299" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 300px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">10.3 ถ้า verify ผ่าน <b><u>แต่</u></b> user ยังไม่ได้ทำการ login เข้าสู่ระบบ<br />จะได้หน้า <font color="#0000ff">/oauth/signin</font> กลับไป</div></div></foreignObject><text x="150" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(22.5,1851.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="97" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 98px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">วนกลับไปข้อ 1 ใหม่</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">วนกลับไปข้อ 1 ใหม่</text></switch></g><path d="M 148 1222 L 1003.63 1222" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 1222 L 1001.88 1225.5 L 1003.63 1222 L 1001.88 1218.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(7.5,1179.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">11. กรอก <br />username / password<br />(ต่อจาก 10.3)</div></div></foreignObject><text x="58" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(275.5,1193.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">12. กดปุ่ม login / เข้าสู่ระบบ</div></div></foreignObject><text x="69" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">12. กดปุ่ม login / เข้าสู่ระบบ</text></switch></g><g transform="translate(1034.5,1235.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">13. ตรวจสอบ <br /><font color="#0000ff">username</font> / <font color="#0000ff">password</font></div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1291 L 155.37 1291" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 150.12 1291 L 157.12 1287.5 L 155.37 1291 L 157.12 1294.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(569.5,1320.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="288" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 288px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">14.2 ถ้า valid username / password <br />ระบบจะ generate authorization_code กลับไปทาง <font color="#0000ff">redirect_uri?code=xxx&amp;state=yyy</font></div></div></foreignObject><text x="144" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1370 L 155.37 1370" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 150.12 1370 L 157.12 1366.5 L 155.37 1370 L 157.12 1373.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(594.5,1255.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="261" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 262px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">14.1 ถ้า invalid username or password <br />จะแสดงข้อความว่า username / password ไม่ถูกต้อง</font></div></div></foreignObject><text x="131" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 150 1443 L 543.63 1443" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 548.88 1443 L 541.88 1446.5 L 543.63 1443 L 541.88 1439.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(570.5,1733.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="288" height="55" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 288px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">18.2.1. จัดเก็บ <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font> ไว้<br />(set-cookie) รวมทั้ง verify <font color="#0000ff">session_token</font> ด้วย public key และเช็คสิทธิ์ (authorities) ตามข้อมูล <font color="#0000ff">session_token</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="144" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(575.5,1403.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="334" height="112" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 334px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">16. อ่าน parameter <font color="#0000ff">code=xxx</font> + verify <font color="#0000ff">state=yyy</font> <br />ว่าผ่านหรือไม่ เพื่อป้องกัน CSRF<br /><br />จากนั้น build http post ด้วย parameters <br /><font color="#0000ff">client_id</font>, <font color="#0000ff">client_secret</font>, <font color="#0000ff">code</font>, <font color="#0000ff">grant_type=authorization_code<br /></font><span style="text-align: center"><br />ส่ง request ไปขอ </span><font color="#0000ff" style="text-align: center">access_token, refresh_token</font><span style="text-align: center"> + ข้อมูล </span><font color="#0000ff" style="text-align: center">session_token</font><span style="text-align: center"> </span><span style="text-align: center">ที่ </span><font color="#0000ff" style="text-align: center">/oauth/token</font><font color="#0000ff"><br /></font></div></div></foreignObject><text x="167" y="62" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1530 L 1003.63 1530" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 1530 L 1001.88 1533.5 L 1003.63 1530 L 1001.88 1526.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1014.5,1562.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 170px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">17. verify request<br />ตรวจสอบ <font color="#0000ff">code</font>, <font color="#0000ff">client_id</font> / <font color="#0000ff">client_scret, user_session</font></div></div></foreignObject><text x="85" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1611 L 556.37 1611" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 551.12 1611 L 558.12 1607.5 L 556.37 1611 L 558.12 1614.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(644.5,1637.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="275" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 276px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">18.2 กรณีที่ verify request ผ่าน<br />ระบบจะ generate <font color="#0000ff">access_token</font>, <font color="#0000ff">refresh_token</font> <br />ข้อมูล <font color="#0000ff">session_token</font> เป็น jwt กลับไปให้ในรูปแบบ json</div></div></foreignObject><text x="138" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1691 L 556.37 1691" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 551.12 1691 L 558.12 1687.5 L 556.37 1691 L 558.12 1694.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(697.5,1569.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 172px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">18.1 กรณีที่ verify request ไม่ผ่าน<br />จะได้ error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="85" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(224.5,1408.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="250" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 252px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">15. browser get &amp; send <font color="#0000ff">code=xxx&amp;state=yyy</font> <br />ไปยัง www.pamarin.com (ต่อจาก 10.3 หรือ 14.2)</div></div></foreignObject><text x="125" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1806 L 156.37 1806" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1806 L 158.12 1802.5 L 156.37 1806 L 158.12 1809.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1023.5,918.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="178" height="55" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 178px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">9. verify request<br />ตรวจสอบ <font color="#0000ff">response_type</font>, <font color="#0000ff">client_id</font>, <font color="#0000ff">redirect_uri</font>,<br /><font color="#0000ff">scope </font>และเช็ค <font color="#0000ff">user_session</font> login</div></div></foreignObject><text x="89" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 255 L 1002.63 255" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1007.88 255 L 1000.88 258.5 L 1002.63 255 L 1000.88 251.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1010 324 L 558.37 324" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 553.12 324 L 560.12 320.5 L 558.37 324 L 560.12 327.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(570.5,513.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="263" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 264px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">5. นำ <font color="#0000ff">refresh_token</font> มา build http post (ต่อจาก 4.2)<br />เพื่อขอ <font color="#0000ff">access_token </font>ใหม่<br />ส่งไปที่ <font color="#0000ff">/oauth/token (</font><font color="#0000ff">grant_type=refresh_token)</font></div></div></foreignObject><text x="132" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(563.5,366.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="225" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 225px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1.1 verify <font color="#0000ff">session_token</font> ด้วย public key จากนั้นเช็คสิทธิ์ (authorities) ตามข้อมูล <br /><font color="#0000ff">session_token</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="113" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 358.5 L 156.37 358.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 358.5 L 158.12 355 L 156.37 358.5 L 158.12 362 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(217.5,318.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">4.1.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 422 L 156.37 422" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 422 L 158.12 418.5 L 156.37 422 L 158.12 425.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(254.5,384.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">4.1.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><path d="M 1010 479 L 558.37 479" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 553.12 479 L 560.12 475.5 L 558.37 479 L 560.12 482.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(649.5,437.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 246px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">4.2 ถ้า access_token หรือ user_session invalid<br />จะ return error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="122" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 577.5 L 1002.63 577.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1007.88 577.5 L 1000.88 581 L 1002.63 577.5 L 1000.88 574 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(623.5,281.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="292" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 293px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1 ถ้า <font color="#0000ff">access_token</font> <b><u>และ</u></b> <font color="#0000ff">user_session</font> valid<br />จะ return <font color="#0000ff">session_token</font> เป็น jwt กลับมาให้ในรูปแบบ json</div></div></foreignObject><text x="146" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1028.5,598.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="69" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 154px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">6. verify request<br />ตรวจสอบ <font color="#0000ff">refresh_token, user_session, client_id, client_secret<br /><br /></font></div></div></foreignObject><text x="77" y="41" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1011.5 660 L 559.87 660" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 554.62 660 L 561.62 656.5 L 559.87 660 L 561.62 663.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(570.5,601.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="353" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 354px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1 ถ้า <font color="#0000ff">refresh_token </font><b><u>และ</u></b><font color="#0000ff"> user_session</font> valid<br />จะ return <font color="#0000ff">access_token, refresh_token </font>ใหม่ + ข้อมูล<font color="#0000ff"> session_token</font> <br />เป็น jwt กลับไปในรูปแบบ json</div></div></foreignObject><text x="177" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(564.5,702.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="321" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 321px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1.1 จัดเก็บ <font color="#0000ff">access_token</font> + <font color="#0000ff">refresh_token</font> ใหม่ (set-cookie) รวมทั้ง verify <font color="#0000ff">session_token</font> ด้วย public key และเช็คสิทธิ์ตามข้อมูล <font color="#0000ff">session_token</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="161" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 702 L 156.37 702" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 702 L 158.12 698.5 L 156.37 702 L 158.12 705.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(261.5,1600.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">18.1.1 return error กลับไปหา user</font></div></div></foreignObject><text x="88" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;font color="#ff0000"&gt;18.1.1 return error กลับไปหา user&lt;/font&gt;</text></switch></g><path d="M 550 765.5 L 156.37 765.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 765.5 L 158.12 762 L 156.37 765.5 L 158.12 769 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(254.5,728.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">7.1.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><path d="M 1009 819.5 L 557.37 819.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 552.12 819.5 L 559.12 816 L 557.37 819.5 L 559.12 823 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(573.5,777.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 245px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">7.2 ถ้า refresh_token หรือ user_session invalid<br />จะ return error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="122" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1632.5 L 156.37 1632.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1632.5 L 158.12 1629 L 156.37 1632.5 L 158.12 1636 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(227.5,672.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">7.1.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1731 L 156.37 1731" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1731 L 158.12 1727.5 L 156.37 1731 L 158.12 1734.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(227.5,1693.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">18.2.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(264.5,1764.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">18.2.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">18.2.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><rect x="1028" y="235" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1058.5,244.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="77" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/session</font></div></div></foreignObject><text x="39" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="562.5" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1064.5,572.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="66" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 67px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/token</font></div></div></foreignObject><text x="33" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="876" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1054.5,885.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="86" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 87px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/authorize</font></div></div></foreignObject><text x="43" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="1520.5" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1064.5,1530.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="66" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 67px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/token</font></div></div></foreignObject><text x="33" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1026.5" y="1192" width="139" height="32" rx="4.8" ry="4.8" fill="#009900" stroke="none" pointer-events="none"/><g transform="translate(1061.5,1201.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="68" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 69px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/signin</font></div></div></foreignObject><text x="34" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(469.5,119.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 155px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Client/Resource Server</font></b></div></div></foreignObject><text x="77" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(93.5,120.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Owner</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(938.5,119.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Authorization Server</font></b></div></div></foreignObject><text x="69" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(788.5,1871.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="124" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 8px">Copyright Pamarin © 2019-Present</font></div></div></foreignObject><text x="62" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(453.5,-0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="53" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 245px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b style="font-size: 23px"><font style="font-size: 23px">OAuth 2.0 Framework <br />for Single Sign-On <br /></font></b></div></div></foreignObject><text x="122" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1057 L 155.37 1057" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 150.12 1057 L 157.12 1053.5 L 155.37 1057 L 157.12 1060.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(563.5,1069.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="288" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 288px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">10.2 ถ้า verify ผ่าน และ user ได้เคย login/signin ไปแล้ว <br /><span style="text-align: center">ระบบจะ generate authorization_code กลับไปทาง </span><font color="#0000ff" style="text-align: center">redirect_uri?code=xxx&amp;state=yyy</font><font color="#0000ff" style="text-align: center"><br /></font></div></div></foreignObject><text x="144" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(165.5,1070.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="90" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 90px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left">ไปต่อที่ข้อ 15 เลย</span></div></div></foreignObject><text x="45" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1133.5,142.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="125" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">private key <br />(ไว้ sign session_token)</font></div></div></foreignObject><text x="63" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 637.08 157.14 C 635.94 156.98 635.07 156.02 635 154.86 L 635 144.86 C 635.24 143.86 636.07 143.12 637.08 143 L 650.75 143 C 651.82 143.05 652.74 143.8 653 144.86 L 653 154.86 C 652.91 155.94 652.07 156.81 651.01 156.93 L 648.85 156.93 C 647.99 157.71 647.26 158.62 646.7 159.63 C 646.41 160.35 646.36 161.14 646.56 161.88 L 648.47 164.79 L 647.22 166.58 L 646.42 167.42 L 646.42 168.65 C 647.01 169.19 647.66 169.66 648.36 170.06 L 648.4 171.11 L 647.57 171.7 C 647.35 171.97 647.27 172.32 647.36 172.65 L 647.32 174.62 L 646.42 174.76 C 646.43 175.6 646.11 176.41 645.52 177.01 C 644.94 177.61 644.14 177.95 643.31 177.95 C 642.46 178 641.64 177.7 641.02 177.11 C 640.4 176.53 640.04 175.72 640.02 174.86 L 640.02 157.14 Z M 641.44 175.04 C 641.59 175.57 641.88 175.9 642.18 175.9 C 642.49 175.9 642.77 175.57 642.93 175.04 L 642.93 158.3 C 642.77 157.77 642.49 157.44 642.18 157.44 C 641.88 157.44 641.59 157.77 641.44 158.3 Z M 644 148.9 C 645.15 148.9 646.08 147.95 646.08 146.79 C 646.1 146.22 645.89 145.67 645.49 145.26 C 645.1 144.85 644.56 144.61 644 144.61 C 643.44 144.61 642.9 144.85 642.51 145.26 C 642.11 145.67 641.9 146.22 641.92 146.79 C 641.92 147.95 642.85 148.9 644 148.9 Z" fill="#7d7d7d" stroke="none" pointer-events="none"/><g transform="translate(554.5,78.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="43" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 44px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Signin</font></b></div></div></foreignObject><text x="22" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><image x="1095.5" y="142.5" width="23" height="38" xlink:href="https://www.draw.io/img/lib/mscae/Key.svg" pointer-events="none"/><g transform="translate(668.5,144.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="132" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 133px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">public key <br />(ไว้ verify session_token)</font></div></div></foreignObject><text x="66" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>