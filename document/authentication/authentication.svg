<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1187px" height="1887px" viewBox="-0.5 -0.5 1187 1887" content="&lt;mxfile modified=&quot;2019-08-07T13:30:32.718Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36&quot; etag=&quot;vA9oCS8-tWM0Kq0emR5o&quot; version=&quot;11.1.2&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;17bl3SH3Tnu5EkGAU0ez&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 148 174 L 148 1871.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 148 1876.88 L 144.5 1869.88 L 148 1871.63 L 151.5 1869.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 173 L 550 1871.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 550 1876.88 L 546.5 1869.88 L 550 1871.63 L 553.5 1869.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="490" y="133" width="120" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(500.5,146.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 99px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">www.pamarin.com</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">www.pamarin.com</text></switch></g><rect x="88" y="134" width="120" height="40" fill="#f5f5f5" stroke="#666666" pointer-events="none"/><g transform="translate(111.5,147.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">User/Browser</div></div></foreignObject><text x="37" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">User/Browser</text></switch></g><path d="M 1010 173 L 1010 1871.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1010 1876.88 L 1006.5 1869.88 L 1010 1871.63 L 1013.5 1869.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="940" y="133" width="140" height="40" fill="#fff2cc" stroke="#d6b656" pointer-events="none"/><g transform="translate(955.5,146.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="109" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 110px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">authen.pamarin.com</div></div></foreignObject><text x="55" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">authen.pamarin.com</text></switch></g><path d="M 150 215 L 543.63 215" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 548.88 215 L 541.88 218.5 L 543.63 215 L 541.88 211.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 889 L 1003.63 889" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 889 L 1001.88 892.5 L 1003.63 889 L 1001.88 885.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(573.5,202.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="272" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 273px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">2. นำ <font color="#0000ff">access_token</font> มา build http post <br />ส่งไปตรวจสอบที่ <font color="#0000ff">authen.pamarin/com/oauth/session</font></div></div></foreignObject><text x="136" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(239.5,176.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">1. เข้าใช้งาน <br />cookie : <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(564.5,861.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="347" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 348px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">8. redirect ไปที่  <font color="#0000ff"><span>authen.pamarin/com</span>/oauth/authorize</font> (ต่อจาก 7.2)</div></div></foreignObject><text x="174" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">8. redirect ไปที่  &lt;font color="#0000ff"&gt;&lt;span&gt;authen.pamarin/com&lt;/span&gt;/oauth/authorize&lt;/font&gt; (ต่อจาก 7.2)</text></switch></g><g transform="translate(565.5,902.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="337" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 338px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">querystring : <font color="#0000ff">response_type</font>, <font color="#0000ff">client_id</font>, <font color="#0000ff">redirect_uri</font>, <font color="#0000ff">scope</font>, <font color="#0000ff">state</font></div></div></foreignObject><text x="169" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1024.5,266.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 154px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">3. verify <font color="#0000ff">access_token </font>&amp;<font color="#0000ff"> user_session </font>in database</div></div></foreignObject><text x="77" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1010 969 L 156.37 969" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 969 L 158.12 965.5 L 156.37 969 L 158.12 972.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(561.5,981.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="247" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 247px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">10.1 ถ้า verify request ไม่ผ่าน จะได้ error กลับไปทาง redirect_uri?error=xxx</font></div></div></foreignObject><text x="124" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1008 1049 L 154.37 1049" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 149.12 1049 L 156.12 1045.5 L 154.37 1049 L 156.12 1052.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(562.5,1057.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="267" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 268px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">10.2 ถ้า verify ผ่าน <br />จะได้หน้า <font color="#0000ff"><span>authen.pamarin/com</span>/oauth/signin</font> กลับไป</div></div></foreignObject><text x="134" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(22.5,1832.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="97" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 98px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">วนกลับไปข้อ 1 ใหม่</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">วนกลับไปข้อ 1 ใหม่</text></switch></g><path d="M 148 1130 L 1003.63 1130" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 1130 L 1001.88 1133.5 L 1003.63 1130 L 1001.88 1126.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(7.5,1087.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">11. กรอก <br />username / password<br />(ต่อจาก 10.2)</div></div></foreignObject><text x="58" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(275.5,1101.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">12. กดปุ่ม login / เข้าสู่ระบบ</div></div></foreignObject><text x="69" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">12. กดปุ่ม login / เข้าสู่ระบบ</text></switch></g><g transform="translate(1034.5,1143.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 116px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">13. ตรวจสอบ <br /><font color="#0000ff">username</font> / <font color="#0000ff">password</font></div></div></foreignObject><text x="58" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1199 L 155.37 1199" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 150.12 1199 L 157.12 1195.5 L 155.37 1199 L 157.12 1202.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(569.5,1228.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="288" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 288px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">14.2 ถ้า valid username / password <br />ระบบจะ generate authorization_code กลับไปทาง <font color="#0000ff">redirect_uri?code=xxx&amp;state=yyy</font></div></div></foreignObject><text x="144" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1278 L 155.37 1278" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 150.12 1278 L 157.12 1274.5 L 155.37 1278 L 157.12 1281.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(594.5,1163.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="261" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 262px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">14.1 ถ้า invalid username or password <br />จะแสดงข้อความว่า username / password ไม่ถูกต้อง</font></div></div></foreignObject><text x="131" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 150 1351 L 543.63 1351" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 548.88 1351 L 541.88 1354.5 L 543.63 1351 L 541.88 1347.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(574.5,1677.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="248" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 249px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">19.2.1. จัดเก็บ <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font> ไว้<br />(set-cookie) <span>รวมทั้งเช็คสิทธิ์ตามข้อมูล </span><br /><font color="#0000ff">user_session</font><span> ที่ระบบ authen ส่งมาให้</span></div></div></foreignObject><text x="124" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(575.5,1311.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="323" height="112" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 324px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">16. อ่าน parameter <font color="#0000ff">code=xxx</font> + verify <font color="#0000ff">state=yyy</font> <br />ว่าผ่านหรือไม่ เพื่อป้องกัน CSRF<br /><br />จากนั้น build http post ด้วย parameters <br /><font color="#0000ff">client_id</font>, <font color="#0000ff">client_secret</font>, <font color="#0000ff">code</font>, <font color="#0000ff">grant_type=authorization_code<br /></font><span style="text-align: center"><br />ส่ง request ไปขอ </span><font color="#0000ff" style="text-align: center">access_token</font><span style="text-align: center"> + ข้อมูล </span><font color="#0000ff" style="text-align: center">user_session</font><span style="text-align: center"> </span><br style="text-align: center" /><span style="text-align: center">ที่ </span><font color="#0000ff" style="text-align: center">authen.pamarin.com/oauth/token</font><font color="#0000ff"><br /></font></div></div></foreignObject><text x="162" y="62" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1438 L 1003.63 1438" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008.88 1438 L 1001.88 1441.5 L 1003.63 1438 L 1001.88 1434.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1014.5,1470.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 170px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">18. verify request<br />ตรวจสอบ <font color="#0000ff">code</font>, <font color="#0000ff">client_id</font> / <font color="#0000ff">client_scret</font></div></div></foreignObject><text x="85" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1519 L 556.37 1519" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 551.12 1519 L 558.12 1515.5 L 556.37 1519 L 558.12 1522.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(653.5,1610.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="248" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 250px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">19.2 กรณีที่ verify request ผ่าน<br />ระบบจะ generate <font color="#0000ff">access_token</font>, <font color="#0000ff">refresh_token</font> <br />ข้อมูล <font color="#0000ff">user_session</font> กลับไปให้ในรูปแบบ json</div></div></foreignObject><text x="124" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 1599 L 556.37 1599" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 551.12 1599 L 558.12 1595.5 L 556.37 1599 L 558.12 1602.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(692.5,1530.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="170" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 172px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">19.1 กรณีที่ verify request ไม่ผ่าน<br />จะได้ error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="85" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(245.5,1321.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="209" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 210px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">15. browser send <font color="#0000ff">code=xxx&amp;state=yyy</font> <br />ไปยัง www.pamarin.com (ต่อจาก 14.2)</div></div></foreignObject><text x="105" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1787 L 156.37 1787" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1787 L 158.12 1783.5 L 156.37 1787 L 158.12 1790.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1023.5,909.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="55" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 154px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">9. verify request<br />ตรวจสอบ <font color="#0000ff">response_type</font>, <font color="#0000ff">client_id</font>, <font color="#0000ff">redirect_uri</font>,<br /><font color="#0000ff">scope</font></div></div></foreignObject><text x="77" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 246 L 1002.63 246" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1007.88 246 L 1000.88 249.5 L 1002.63 246 L 1000.88 242.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1010 315 L 558.37 315" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 553.12 315 L 560.12 311.5 L 558.37 315 L 560.12 318.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(570.5,504.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="363" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 364px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">5. นำ <font color="#0000ff">refresh_token</font> มา build http post (ต่อจาก 4.2)<br />เพื่อขอ <font color="#0000ff">access_token </font>ใหม่<br />ส่งไปที่ <font color="#0000ff">authen.pamarin.com/oauth/token (</font><font color="#0000ff">grant_type=refresh_token)</font></div></div></foreignObject><text x="182" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(563.5,335.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="194" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 195px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1.1 เช็คสิทธิ์ (authorities) ตามข้อมูล <br /><font color="#0000ff">user_session</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="97" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 349.5 L 156.37 349.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 349.5 L 158.12 346 L 156.37 349.5 L 158.12 353 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(217.5,309.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">4.1.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 413 L 156.37 413" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 413 L 158.12 409.5 L 156.37 413 L 158.12 416.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(254.5,375.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">4.1.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><path d="M 1010 470 L 558.37 470" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 553.12 470 L 560.12 466.5 L 558.37 470 L 560.12 473.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(673.5,428.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="188" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 189px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">4.2 ถ้า access_token invalid<br />จะ return error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="94" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 568.5 L 1002.63 568.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1007.88 568.5 L 1000.88 572 L 1002.63 568.5 L 1000.88 565 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(659.5,276.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="245" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 246px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4.1 ถ้า <font color="#0000ff">access_token</font> valid<br />จะ return <font color="#0000ff">user_session</font> กลับมาให้ในรูปแบบ json</div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1028.5,596.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="55" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 154px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">6. verify request<br />ตรวจสอบ <font color="#0000ff">refresh_token, client_id, client_secret<br /><br /></font></div></div></foreignObject><text x="77" y="34" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1011.5 651 L 559.87 651" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 554.62 651 L 561.62 647.5 L 559.87 651 L 561.62 654.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(570.5,592.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="348" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 349px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1 ถ้า <font color="#0000ff">refresh_token</font> valid<br />จะ return <font color="#0000ff">access_token, refresh_token </font>ใหม่ + ข้อมูล<font color="#0000ff"> user_session</font> <br />กลับไปในรูปแบบ json</div></div></foreignObject><text x="174" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(563.5,668.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="241" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 241px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1.1 จัดเก็บ <font color="#0000ff">access_token</font> + <font color="#0000ff">refresh_token</font> ใหม่ (set-cookie) รวมทั้งเช็คสิทธิ์ตามข้อมูล <br /><font color="#0000ff">user_session</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="121" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 693 L 156.37 693" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 693 L 158.12 689.5 L 156.37 693 L 158.12 696.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(256.5,1534.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">19.1.1 return error กลับไปหา user</font></div></div></foreignObject><text x="88" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;font color="#ff0000"&gt;19.1.1 return error กลับไปหา user&lt;/font&gt;</text></switch></g><path d="M 550 756.5 L 156.37 756.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 756.5 L 158.12 753 L 156.37 756.5 L 158.12 760 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(254.5,719.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7.1.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">7.1.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><path d="M 1009 810.5 L 557.37 810.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 552.12 810.5 L 559.12 807 L 557.37 810.5 L 559.12 814 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(573.5,768.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="188" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 189px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">7.2 ถ้า refresh_token invalid<br />จะ return error กลับไปในรูปแบบ json</font></div></div></foreignObject><text x="94" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1519.5 L 156.37 1519.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1519.5 L 158.12 1516 L 156.37 1519.5 L 158.12 1523 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(227.5,663.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">7.1.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 550 1712 L 156.37 1712" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.12 1712 L 158.12 1708.5 L 156.37 1712 L 158.12 1715.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(227.5,1682.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="246" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 248px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ff0000">19.2.1.1 ถ้าไม่มีสิทธิ์เข้าถึง<br />จะ return error (access denied) กลับไปหา user </font></div></div></foreignObject><text x="123" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(264.5,1749.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="176" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 177px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">19.2.1.2 ถ้ามีสิทธิ์เข้าถึง <br />จะ return resource กลับไปหา user</div></div></foreignObject><text x="88" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">19.2.1.2 ถ้ามีสิทธิ์เข้าถึง &lt;br&gt;จะ return resource กลับไปหา user</text></switch></g><rect x="1028" y="226" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1058.5,235.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="77" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/session</font></div></div></foreignObject><text x="39" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="553.5" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1064.5,563.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="66" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 67px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/token</font></div></div></foreignObject><text x="33" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="867" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1054.5,876.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="86" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 87px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/authorize</font></div></div></foreignObject><text x="43" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1028" y="1428.5" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1064.5,1438.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="66" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 67px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/token</font></div></div></foreignObject><text x="33" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1026.5" y="1100" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1061.5,1109.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="68" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 69px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/signin</font></div></div></foreignObject><text x="34" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(469.5,110.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 155px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Client/Resource Server</font></b></div></div></foreignObject><text x="77" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(93.5,111.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Owner</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(938.5,110.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Authorization Server</font></b></div></div></foreignObject><text x="69" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(788.5,1852.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="124" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 8px">Copyright Pamarin © 2019-Present</font></div></div></foreignObject><text x="62" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(453.5,-1.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="81" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 245px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b style="font-size: 23px"><font style="font-size: 23px">OAuth 2.0 Framework <br />for Single Sign-On <br />Flow</font></b></div></div></foreignObject><text x="122" y="47" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>