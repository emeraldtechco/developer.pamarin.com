<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1404px" height="574px" viewBox="-0.5 -0.5 1404 574" content="&lt;mxfile modified=&quot;2019-08-09T10:23:06.447Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&quot; etag=&quot;PeHVfCat3zi6TYnzrKYm&quot; version=&quot;11.1.4&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;ZUCVGU48ia1j9YudHy5W&quot; name=&quot;Page-1&quot;&gt;7VzbkqM2EP0aV20e7BLi/mjPJZfK1m5lksrmaQsbYWsHI0fIY3u/PhJI3ITH9gwwiTOzVWtoJIG6j0631IKRebPe/0iDzeojCVE8giDcj8zbEYTQdD3+IySHXGJYPswlS4pDKSsFD/g7kkIgpVscorRWkBESM7ypCxckSdCC1WQBpWRXLxaRuH7XTbBEmuBhEcS69E8cspWUGo5fXvgJ4eVK3tqDbn5hHajCsifpKgjJriIy70bmDSWE5Ufr/Q2KhfaUXvJ690euFg9GUcLOqXD4/Y9Z6Py5p9/WD48UO79Q7++xbCVlB9VhFPL+y1NC2YosSRLEd6V0Rsk2CZFoFfCzssyvhGy40ODCb4ixgzRmsGWEi1ZsHcurYZCusvriBO0x+yLamtjy7K/Kldu9vE12cpAnetdVP8iWLtAz/bXycqKTlYpSYT8iskaMHngBiuKA4ac6CAKJpWVRrqj6mWD+KBBI4I8taXQJ+7Fhg3obLKBLxGS10mr8oPIcpSiz5QV2hW9u15fbyBzGRiZ4YxvJfj4F8Vb2YbfbTTbBOqA4mSzIWrNh3UK7FWboYRNkytxx/q1bI8JxfENiQrO6ZhggL1pwecooeUSVK87CQ/PoOZM9IcrQ/lljKMZvAt927Vywq7CnosRVhTgtcNyANc1fqmZLU/MfKaK8qZnwDuKoQy1HtvjXquXsT9QgCavI879utD82mpi2XeuN1W//h5nIGYaJfP+NmcjRhghX6QolvZFRFEVw0UpGoTN3bKeb4eDDc8jIGnI0uJqm9eGRhFMRuPKzRRykKV7UVXlUMSdhWum13dJpJes69rF8s95GPu40NJ/20FpLPY8LX7MWnPDz0R0YzbyR78uDmSmE0ImZpPdsPqIg7fy9FSE+txvvDwBRVBU5S/EbLBYoTb8yPhQS1Q5/4LypvEh526mhbiuebb7FfEbDDcnYRsCCpKzyMHNa1JeVp9mBP/I8KfFcJbFUv1Rh31a1THXgqlpevUF+cKtqKYmvCs/s8qavUxRXChHUxH9TrjFMjqurMao4ZbD6OKpTT0IS1OApKQpivEz4aYwi0YKgH8znh1MpXuMwzJxWGwPWObIDSjMVYRSUBqBGaaZv6KMb9kVpaqZeGSWGGCVcR6JusME6GheEPGIkwGBOhxk7vIuvuw9FEUXp6sSNOkfdgmOFx6hvjTvDasAOehrsYFtc2R/s9OmTOcn7hCPevBOshSaSebrJrdgRwsBR28s75v+/juXAlk9MvhYUd+yeWFwLAxZkqCNUjKgPFIU4/eGKoQiA0QgLTB2MhgcHBKOpRwpXF9fp0ZgDXxbXafMdraWe4zpLd1lXZy5NyebLw3B4oqWezWXr5rImmYbYllbp8SVkK0n2hF9veBMZzoJ6xOyrYDqbG0DwbcfKsN1TYftURdUzoxkxV0N72WAReRe38JuXinlIEabPfO3BtHv5IvD6lgr3cq2ewmzO/y2VnKlGLb4/oKNw9KWWc8AbZX9dzodKZRsXr96IoXR/fwwX3bh4u2E55c6rLt5ssZwJe7Kcaxy13LzCE1VTlupWdhMXxmm2aimGn2Ft9rpR7wndBTTEyZIXmWYLcWIQseesW4jnRy1+PcPac+rgcJSDqA5rMORkxIVDgeM3JFetIfi0S0T24h0RcOy7dUTYitR3tZz9kIjQp6c9IUIwBKH4uyQI8IDo0zsusquegkHBFEBnCsN1h8SF/RwuTmMAmm0YuBRJ7a18mmahBIAT3ntwT4M12hH6OGpbT4642TnWuJOKUXawTMafktai71AUTstpxKJOC0W1zgf7g6Kvqfu/k5r1pFb6zs06ViMSHTo36+mT32CD+8vMegvUnpmde7ZldzQabK+hVdt1dGIedJ+CN1h8Xwnh3n11CQm7AQlHLfO+ma9Wc85rXiY0gVlXu9lU57nLhI51qqW+mVIPue1e0vXnLRlekK+/NFlfpOYrl2T+vS2PP4XNFUfejszMAq2wXV+DrFQvE/qw0k7nhPQvSbQ30WzrO+mGXTv09KmDW8W3U18hrpjplRs5ikszq4kE36tf4nfnnQMfgnxSyjASqcjiEW+aqC0f0T86DMrCYFRZ9Kco3ZAkRaMLltjro+NqoduYakCvZX0MDupJ25a9r8yTav5Pi1XPT7idaqlvT6pvU3SqeysG9J6+1WS1grqmGR6285gjBYJHdKgwgcYvZQLMr3NDpWW/SK0V7RS0UfCl4o/uSFF3uIWbhlrnb5tlilwfJ73nVl8GMFXbfr+G35kVhWt5yHy7cSVmOh75nJkjvVJud9zGLAn6+pbmgbndu35u1/a+FOmlS7ld2x2ttdQ3t+tblbwiiqxuFNAmBNmkId9IGeUpyk6isNrYlbOkbfZeTnML35UN6QIBZkt4Zg05hH19jfHSpS6vbaXrhmwONHt+CD7nC5YCJzdwNBX7YyAw/PFnjiCUsKPe5VrXuxyvQQSG3wIDtetgGBgMtgR6E+PM5vfva6Gtb1EaXh0bg+Yt0c/RR2SN4y+bL98/Gr8Fs/swUi8Uv4IhDNiGhGb8rsWvH5ouY+pWorxySlKLVX8Yjk668iEaOlowdBQwFmgkum31fYIqYPp6LaQVMMfz3O+AeXvAuDZsAMY1Ji0vRw4KmZN7I18KGYqfAoZejplUmOh/jhjDMHTIvDFgzph5bsQ8CtG7J97NVOlffYlFqKbYjwDOMFIczFH8maQ422vVEi/82igwJ4yRdYvxmNguMSNbFuOE30V9vAa0BSP8eTeiO+v9UnxlZ0KiCC/QJEWLLcXsMOGo/rpBdI0zeKYjLanv3s+mFuwGB8UnfUoY6JuqjZa8SBeZ+1YUnPHuzTsKOkaBq6r8a1DQ8hrqOwzaYHA7tQB0uoGBATww0bby9IYEflp+LytfECs/O2be/QM=&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 60 181 L 60 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 60 563.88 L 56.5 556.88 L 60 558.63 L 63.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 400 180 L 400 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 400 563.88 L 396.5 556.88 L 400 558.63 L 403.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="340" y="140" width="120" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(350.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 99px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">www.pamarin.com</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">www.pamarin.com</text></switch></g><rect x="0" y="141" width="120" height="40" fill="#f5f5f5" stroke="#666666" pointer-events="none"/><g transform="translate(23.5,154.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">User/Browser</div></div></foreignObject><text x="37" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">User/Browser</text></switch></g><path d="M 1090 180 L 1090 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1090 563.88 L 1086.5 556.88 L 1090 558.63 L 1093.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1020" y="140" width="140" height="40" fill="#fff2cc" stroke="#d6b656" pointer-events="none"/><g transform="translate(1035.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="109" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 110px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">authen.pamarin.com</div></div></foreignObject><text x="55" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">authen.pamarin.com</text></switch></g><path d="M 60 222 L 393.63 222" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 222 L 391.88 225.5 L 393.63 222 L 391.88 218.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(423.5,209.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">2. นำ <font color="#0000ff">access_token</font> มา build http post <br />ส่งไปตรวจสอบที่ <font color="#0000ff">/oauth/session</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(123.5,183.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">1. call api<br />cookie : <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1101.5,273.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 180px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">3. verify <font color="#0000ff">access_token </font>&amp;<font color="#0000ff"> user_session </font>in data store (redis)</div></div></foreignObject><text x="90" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 253 L 1083.63 253" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1088.88 253 L 1081.88 256.5 L 1083.63 253 L 1081.88 249.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1090 322 L 408.37 322" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403.12 322 L 410.12 318.5 L 408.37 322 L 410.12 325.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,291.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="290" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 291px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4. return <font color="#0000ff">session_token</font> เป็น jwt กลับมาให้ในรูปแบบ json</div></div></foreignObject><text x="145" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">4. return &lt;font color="#0000ff"&gt;session_token&lt;/font&gt; เป็น jwt กลับมาให้ในรูปแบบ json</text></switch></g><rect x="1105" y="233" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1135.5,242.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="77" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/session</font></div></div></foreignObject><text x="39" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(496.5,67.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="178" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 179px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Forwarding Authentication</font></b></div></div></foreignObject><text x="89" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;b&gt;&lt;font style="font-size: 14px"&gt;Forwarding Authentication&lt;/font&gt;&lt;/b&gt;</text></switch></g><g transform="translate(5.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Owner</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1018.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Authorization Server</font></b></div></div></foreignObject><text x="69" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(462.5,-0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="53" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 245px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b style="font-size: 23px"><font style="font-size: 23px">OAuth 2.0 Framework <br />for Single Sign-On <br /></font></b></div></div></foreignObject><text x="122" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 745 179 L 745 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 745 563.88 L 741.5 556.88 L 745 558.63 L 748.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="685" y="139" width="120" height="40" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(700.5,152.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="89" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 89px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">api.pamarin.com</div></div></foreignObject><text x="45" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">api.pamarin.com</text></switch></g><g transform="translate(687.5,116.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Server</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 403 395 L 736.63 395" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 741.88 395 L 734.88 398.5 L 736.63 395 L 734.88 391.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,357.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">5. นำ <font color="#0000ff">session_token</font> มา build http post<br />ส่งต่อไปยัง api ปลายทาง</div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(421.5,431.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="186" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 187px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน<br />จะ return response กลับไป</div></div></foreignObject><text x="93" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน&lt;br&gt;จะ return response กลับไป</text></switch></g><path d="M 743 475 L 409.37 475" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 404.12 475 L 411.12 471.5 L 409.37 475 L 411.12 478.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(776.5,409.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="225" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 225px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">6. verify <font color="#0000ff">session_token</font> ด้วย public key จากนั้นเช็คสิทธิ์ (authorities) ตามข้อมูล <br /><font color="#0000ff">session_token</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="113" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 515 L 66.37 515" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 61.12 515 L 68.12 511.5 L 66.37 515 L 68.12 518.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(101.5,488.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="227" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 228px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">8. แปลง / forward response กลับไปหา user </div></div></foreignObject><text x="114" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">8. แปลง / forward response กลับไปหา user </text></switch></g><g transform="translate(853.5,528.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="124" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 8px">Copyright Pamarin © 2019-Present</font></div></div></foreignObject><text x="62" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(329.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 155px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Client/Resource Server</font></b></div></div></foreignObject><text x="77" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(510.5,142.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="132" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 133px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">public key <br />(ไว้ verify session_token)</font></div></div></foreignObject><text x="66" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(853.5,140.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="132" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 133px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">public key <br />(ไว้ verify session_token)</font></div></div></foreignObject><text x="66" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1213.5,140.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="125" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">private key <br />(ไว้ sign session_token)</font></div></div></foreignObject><text x="63" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 487.43 148.21 C 489.19 148.21 490.42 146.82 490.42 145.24 C 490.42 143.77 489.27 142.28 487.39 142.28 C 486.04 142.28 484.46 143.34 484.46 145.32 C 484.46 146.8 485.72 148.21 487.43 148.21 Z M 483.72 173.89 L 483.72 156.76 C 480.67 155.33 478 151.87 478 147.94 C 478 142.38 482.22 138 487.45 138 C 492.77 138 497 142.35 497 148.07 C 497 151.57 494.44 155.06 491.16 156.77 L 491.16 160.77 L 488.41 163.68 L 491.85 167.22 L 491.85 167.39 L 488.76 170.64 L 491.67 173.72 L 487.5 178 Z" fill="#7fba42" stroke="none" pointer-events="none"/><path d="M 830.43 148.21 C 832.19 148.21 833.42 146.82 833.42 145.24 C 833.42 143.77 832.27 142.28 830.39 142.28 C 829.04 142.28 827.46 143.34 827.46 145.32 C 827.46 146.8 828.72 148.21 830.43 148.21 Z M 826.72 173.89 L 826.72 156.76 C 823.67 155.33 821 151.87 821 147.94 C 821 142.38 825.22 138 830.45 138 C 835.77 138 840 142.35 840 148.07 C 840 151.57 837.44 155.06 834.16 156.77 L 834.16 160.77 L 831.41 163.68 L 834.85 167.22 L 834.85 167.39 L 831.76 170.64 L 834.67 173.72 L 830.5 178 Z" fill="#7fba42" stroke="none" pointer-events="none"/><path d="M 1189.93 148.21 C 1191.69 148.21 1192.92 146.82 1192.92 145.24 C 1192.92 143.77 1191.77 142.28 1189.89 142.28 C 1188.54 142.28 1186.96 143.34 1186.96 145.32 C 1186.96 146.8 1188.22 148.21 1189.93 148.21 Z M 1186.22 173.89 L 1186.22 156.76 C 1183.17 155.33 1180.5 151.87 1180.5 147.94 C 1180.5 142.38 1184.72 138 1189.95 138 C 1195.27 138 1199.5 142.35 1199.5 148.07 C 1199.5 151.57 1196.94 155.06 1193.66 156.77 L 1193.66 160.77 L 1190.91 163.68 L 1194.35 167.22 L 1194.35 167.39 L 1191.26 170.64 L 1194.17 173.72 L 1190 178 Z" fill="#da4026" stroke="none" pointer-events="none"/></g></svg>