<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1284px" height="574px" viewBox="-0.5 -0.5 1284 574" content="&lt;mxfile modified=&quot;2019-08-09T09:01:45.655Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36&quot; etag=&quot;cyqvIWBxg08AmOeGL5AT&quot; version=&quot;11.1.4&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;ZUCVGU48ia1j9YudHy5W&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 60 181 L 60 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 60 563.88 L 56.5 556.88 L 60 558.63 L 63.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 400 180 L 400 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 400 563.88 L 396.5 556.88 L 400 558.63 L 403.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="340" y="140" width="120" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(350.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 99px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">www.pamarin.com</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">www.pamarin.com</text></switch></g><rect x="0" y="141" width="120" height="40" fill="#f5f5f5" stroke="#666666" pointer-events="none"/><g transform="translate(23.5,154.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">User/Browser</div></div></foreignObject><text x="37" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">User/Browser</text></switch></g><path d="M 1090 180 L 1090 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1090 563.88 L 1086.5 556.88 L 1090 558.63 L 1093.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1020" y="140" width="140" height="40" fill="#fff2cc" stroke="#d6b656" pointer-events="none"/><g transform="translate(1035.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="109" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 110px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">authen.pamarin.com</div></div></foreignObject><text x="55" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">authen.pamarin.com</text></switch></g><path d="M 60 222 L 393.63 222" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 222 L 391.88 225.5 L 393.63 222 L 391.88 218.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(423.5,209.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">2. นำ <font color="#0000ff">access_token</font> มา build http post <br />ส่งไปตรวจสอบที่ <font color="#0000ff">/oauth/session</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(123.5,183.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">1. call api<br />cookie : <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1101.5,273.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 180px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">3. verify <font color="#0000ff">access_token </font>&amp;<font color="#0000ff"> user_session </font>in data store (redis)</div></div></foreignObject><text x="90" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 253 L 1083.63 253" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1088.88 253 L 1081.88 256.5 L 1083.63 253 L 1081.88 249.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1090 322 L 408.37 322" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403.12 322 L 410.12 318.5 L 408.37 322 L 410.12 325.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,291.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="290" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 291px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4. return <font color="#0000ff">session_token</font> เป็น jwt กลับมาให้ในรูปแบบ json</div></div></foreignObject><text x="145" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">4. return &lt;font color="#0000ff"&gt;session_token&lt;/font&gt; เป็น jwt กลับมาให้ในรูปแบบ json</text></switch></g><rect x="1105" y="233" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1135.5,242.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="77" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/session</font></div></div></foreignObject><text x="39" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(496.5,67.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="178" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 179px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Forwarding Authentication</font></b></div></div></foreignObject><text x="89" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;b&gt;&lt;font style="font-size: 14px"&gt;Forwarding Authentication&lt;/font&gt;&lt;/b&gt;</text></switch></g><g transform="translate(5.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Owner</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1018.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Authorization Server</font></b></div></div></foreignObject><text x="69" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(462.5,-0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="53" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 245px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b style="font-size: 23px"><font style="font-size: 23px">OAuth 2.0 Framework <br />for Single Sign-On <br /></font></b></div></div></foreignObject><text x="122" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 745 179 L 745 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 745 563.88 L 741.5 556.88 L 745 558.63 L 748.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="685" y="139" width="120" height="40" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(700.5,152.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="89" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 89px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">api.pamarin.com</div></div></foreignObject><text x="45" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">api.pamarin.com</text></switch></g><g transform="translate(687.5,116.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Server</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 403 395 L 736.63 395" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 741.88 395 L 734.88 398.5 L 736.63 395 L 734.88 391.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,357.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">5. นำ <font color="#0000ff">session_token</font> มา build http post<br />ส่งต่อไปยัง api ปลายทาง</div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(421.5,431.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="186" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 187px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน<br />จะ return response กลับไป</div></div></foreignObject><text x="93" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน&lt;br&gt;จะ return response กลับไป</text></switch></g><path d="M 743 475 L 409.37 475" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 404.12 475 L 411.12 471.5 L 409.37 475 L 411.12 478.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(776.5,409.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="225" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 225px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">6. verify <font color="#0000ff">session_token</font> ด้วย public key จากนั้นเช็คสิทธิ์ (authorities) ตามข้อมูล <br /><font color="#0000ff">session_token</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="113" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 515 L 66.37 515" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 61.12 515 L 68.12 511.5 L 66.37 515 L 68.12 518.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(101.5,488.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="227" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 228px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">8. แปลง / forward response กลับไปหา user </div></div></foreignObject><text x="114" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">8. แปลง / forward response กลับไปหา user </text></switch></g><g transform="translate(853.5,528.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="124" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 8px">Copyright Pamarin © 2019-Present</font></div></div></foreignObject><text x="62" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(329.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 155px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Client/Resource Server</font></b></div></div></foreignObject><text x="77" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>