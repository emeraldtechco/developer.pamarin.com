<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1404px" height="574px" viewBox="-0.5 -0.5 1404 574" content="&lt;mxfile modified=&quot;2019-08-09T10:27:49.297Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&quot; etag=&quot;y09CIFBSIyOwoPNF35sj&quot; version=&quot;11.1.4&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;ZUCVGU48ia1j9YudHy5W&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 60 181 L 60 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 60 563.88 L 56.5 556.88 L 60 558.63 L 63.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 400 180 L 400 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 400 563.88 L 396.5 556.88 L 400 558.63 L 403.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="340" y="140" width="120" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(350.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 99px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">www.pamarin.com</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">www.pamarin.com</text></switch></g><rect x="0" y="141" width="120" height="40" fill="#f5f5f5" stroke="#666666" pointer-events="none"/><g transform="translate(23.5,154.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">User/Browser</div></div></foreignObject><text x="37" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">User/Browser</text></switch></g><path d="M 1090 180 L 1090 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1090 563.88 L 1086.5 556.88 L 1090 558.63 L 1093.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1020" y="140" width="140" height="40" fill="#fff2cc" stroke="#d6b656" pointer-events="none"/><g transform="translate(1035.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="109" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 110px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">authen.pamarin.com</div></div></foreignObject><text x="55" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">authen.pamarin.com</text></switch></g><path d="M 60 222 L 393.63 222" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 222 L 391.88 225.5 L 393.63 222 L 391.88 218.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(423.5,209.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">2. นำ <font color="#0000ff">access_token</font> มา build http post <br />ส่งไปตรวจสอบที่ <font color="#0000ff">/oauth/session</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(123.5,183.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">1. call api<br />cookie : <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1101.5,273.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 180px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">3. verify <font color="#0000ff">access_token </font>&amp;<font color="#0000ff"> user_session </font>in data store (redis)</div></div></foreignObject><text x="90" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 253 L 1083.63 253" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1088.88 253 L 1081.88 256.5 L 1083.63 253 L 1081.88 249.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1090 322 L 408.37 322" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403.12 322 L 410.12 318.5 L 408.37 322 L 410.12 325.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,291.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="290" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 291px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4. return <font color="#0000ff">session_token</font> เป็น jwt กลับมาให้ในรูปแบบ json</div></div></foreignObject><text x="145" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">4. return &lt;font color="#0000ff"&gt;session_token&lt;/font&gt; เป็น jwt กลับมาให้ในรูปแบบ json</text></switch></g><rect x="1105" y="233" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1135.5,242.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="77" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/session</font></div></div></foreignObject><text x="39" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(496.5,67.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="178" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 179px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Forwarding Authentication</font></b></div></div></foreignObject><text x="89" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;b&gt;&lt;font style="font-size: 14px"&gt;Forwarding Authentication&lt;/font&gt;&lt;/b&gt;</text></switch></g><g transform="translate(5.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Owner</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1018.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Authorization Server</font></b></div></div></foreignObject><text x="69" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(462.5,-0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="53" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 245px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b style="font-size: 23px"><font style="font-size: 23px">OAuth 2.0 Framework <br />for Single Sign-On <br /></font></b></div></div></foreignObject><text x="122" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 745 179 L 745 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 745 563.88 L 741.5 556.88 L 745 558.63 L 748.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="685" y="139" width="120" height="40" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(700.5,152.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="89" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 89px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">api.pamarin.com</div></div></foreignObject><text x="45" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">api.pamarin.com</text></switch></g><g transform="translate(687.5,116.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Server</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 403 395 L 736.63 395" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 741.88 395 L 734.88 398.5 L 736.63 395 L 734.88 391.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,357.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">5. นำ <font color="#0000ff">session_token</font> มา build http post<br />ส่งต่อไปยัง api ปลายทาง</div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(421.5,431.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="186" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 187px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน<br />จะ return response กลับไป</div></div></foreignObject><text x="93" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน&lt;br&gt;จะ return response กลับไป</text></switch></g><path d="M 743 475 L 409.37 475" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 404.12 475 L 411.12 471.5 L 409.37 475 L 411.12 478.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(776.5,409.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="225" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 225px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">6. verify <font color="#0000ff">session_token</font> ด้วย public key จากนั้นเช็คสิทธิ์ (authorities) ตามข้อมูล <br /><font color="#0000ff">session_token</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="113" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 515 L 66.37 515" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 61.12 515 L 68.12 511.5 L 66.37 515 L 68.12 518.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(101.5,488.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="227" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 228px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">8. แปลง / forward response กลับไปหา user </div></div></foreignObject><text x="114" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">8. แปลง / forward response กลับไปหา user </text></switch></g><g transform="translate(853.5,528.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="124" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 8px">Copyright Pamarin © 2019-Present</font></div></div></foreignObject><text x="62" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(329.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 155px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Client/Resource Server</font></b></div></div></foreignObject><text x="77" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(510.5,142.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="132" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 133px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">public key <br />(ไว้ verify session_token)</font></div></div></foreignObject><text x="66" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(853.5,140.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="132" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 133px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">public key <br />(ไว้ verify session_token)</font></div></div></foreignObject><text x="66" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1213.5,140.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="125" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">private key <br />(ไว้ sign session_token)</font></div></div></foreignObject><text x="63" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 490.43 147.96 C 492.19 147.96 493.42 146.6 493.42 145.06 C 493.42 143.62 492.27 142.17 490.39 142.17 C 489.04 142.17 487.46 143.21 487.46 145.14 C 487.46 146.58 488.72 147.96 490.43 147.96 Z M 486.72 172.99 L 486.72 156.29 C 483.67 154.89 481 151.52 481 147.69 C 481 142.27 485.22 138 490.45 138 C 495.77 138 500 142.24 500 147.82 C 500 151.23 497.44 154.63 494.16 156.3 L 494.16 160.2 L 491.41 163.04 L 494.85 166.49 L 494.85 166.65 L 491.76 169.83 L 494.67 172.83 L 490.5 177 Z" fill="#2072b8" stroke="none" pointer-events="none"/><path d="M 832.43 146.46 C 834.19 146.46 835.42 145.1 835.42 143.56 C 835.42 142.12 834.27 140.67 832.39 140.67 C 831.04 140.67 829.46 141.71 829.46 143.64 C 829.46 145.08 830.72 146.46 832.43 146.46 Z M 828.72 171.49 L 828.72 154.79 C 825.67 153.39 823 150.02 823 146.19 C 823 140.77 827.22 136.5 832.45 136.5 C 837.77 136.5 842 140.74 842 146.32 C 842 149.73 839.44 153.13 836.16 154.8 L 836.16 158.7 L 833.41 161.54 L 836.85 164.99 L 836.85 165.15 L 833.76 168.33 L 836.67 171.33 L 832.5 175.5 Z" fill="#2072b8" stroke="none" pointer-events="none"/><path d="M 1190.93 148.96 C 1192.6 148.96 1193.77 147.6 1193.77 146.06 C 1193.77 144.62 1192.68 143.17 1190.89 143.17 C 1189.62 143.17 1188.12 144.21 1188.12 146.14 C 1188.12 147.58 1189.32 148.96 1190.93 148.96 Z M 1187.42 173.99 L 1187.42 157.29 C 1184.53 155.89 1182 152.52 1182 148.69 C 1182 143.27 1186 139 1190.95 139 C 1196 139 1200 143.24 1200 148.82 C 1200 152.23 1197.58 155.63 1194.47 157.3 L 1194.47 161.2 L 1191.86 164.04 L 1195.12 167.49 L 1195.12 167.65 L 1192.19 170.83 L 1194.95 173.83 L 1191 178 Z" fill="#505050" stroke="none" pointer-events="none"/></g></svg>