<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1404px" height="574px" viewBox="-0.5 -0.5 1404 574" content="&lt;mxfile modified=&quot;2019-08-09T10:14:00.600Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&quot; etag=&quot;LVNuhwFTJSxee_lyt9Pb&quot; version=&quot;11.1.4&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;ZUCVGU48ia1j9YudHy5W&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 60 181 L 60 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 60 563.88 L 56.5 556.88 L 60 558.63 L 63.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 400 180 L 400 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 400 563.88 L 396.5 556.88 L 400 558.63 L 403.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="340" y="140" width="120" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(350.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="98" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 99px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">www.pamarin.com</div></div></foreignObject><text x="49" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">www.pamarin.com</text></switch></g><rect x="0" y="141" width="120" height="40" fill="#f5f5f5" stroke="#666666" pointer-events="none"/><g transform="translate(23.5,154.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">User/Browser</div></div></foreignObject><text x="37" y="12" fill="#333333" text-anchor="middle" font-size="12px" font-family="Helvetica">User/Browser</text></switch></g><path d="M 1090 180 L 1090 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1090 563.88 L 1086.5 556.88 L 1090 558.63 L 1093.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1020" y="140" width="140" height="40" fill="#fff2cc" stroke="#d6b656" pointer-events="none"/><g transform="translate(1035.5,153.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="109" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 110px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">authen.pamarin.com</div></div></foreignObject><text x="55" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">authen.pamarin.com</text></switch></g><path d="M 60 222 L 393.63 222" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 398.88 222 L 391.88 225.5 L 393.63 222 L 391.88 218.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(423.5,209.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">2. นำ <font color="#0000ff">access_token</font> มา build http post <br />ส่งไปตรวจสอบที่ <font color="#0000ff">/oauth/session</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(123.5,183.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">1. call api<br />cookie : <font color="#0000ff">access_token</font> / <font color="#0000ff">refresh_token</font></div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1101.5,273.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="180" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 180px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">3. verify <font color="#0000ff">access_token </font>&amp;<font color="#0000ff"> user_session </font>in data store (redis)</div></div></foreignObject><text x="90" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 253 L 1083.63 253" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1088.88 253 L 1081.88 256.5 L 1083.63 253 L 1081.88 249.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1090 322 L 408.37 322" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403.12 322 L 410.12 318.5 L 408.37 322 L 410.12 325.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,291.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="290" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 291px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">4. return <font color="#0000ff">session_token</font> เป็น jwt กลับมาให้ในรูปแบบ json</div></div></foreignObject><text x="145" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">4. return &lt;font color="#0000ff"&gt;session_token&lt;/font&gt; เป็น jwt กลับมาให้ในรูปแบบ json</text></switch></g><rect x="1105" y="233" width="139" height="32" rx="4.8" ry="4.8" fill="#0000ff" stroke="none" pointer-events="none"/><g transform="translate(1135.5,242.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="77" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 78px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font color="#ffffff">/oauth/session</font></div></div></foreignObject><text x="39" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(496.5,67.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="178" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 179px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Forwarding Authentication</font></b></div></div></foreignObject><text x="89" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;b&gt;&lt;font style="font-size: 14px"&gt;Forwarding Authentication&lt;/font&gt;&lt;/b&gt;</text></switch></g><g transform="translate(5.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Owner</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1018.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Authorization Server</font></b></div></div></foreignObject><text x="69" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(462.5,-0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="244" height="53" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 245px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b style="font-size: 23px"><font style="font-size: 23px">OAuth 2.0 Framework <br />for Single Sign-On <br /></font></b></div></div></foreignObject><text x="122" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 745 179 L 745 558.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 745 563.88 L 741.5 556.88 L 745 558.63 L 748.5 556.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="685" y="139" width="120" height="40" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(700.5,152.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="89" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 89px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">api.pamarin.com</div></div></foreignObject><text x="45" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">api.pamarin.com</text></switch></g><g transform="translate(687.5,116.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="111" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 112px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Resource Server</font></b></div></div></foreignObject><text x="56" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 403 395 L 736.63 395" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 741.88 395 L 734.88 398.5 L 736.63 395 L 734.88 391.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(424.5,357.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="201" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 202px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">5. นำ <font color="#0000ff">session_token</font> มา build http post<br />ส่งต่อไปยัง api ปลายทาง</div></div></foreignObject><text x="101" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(421.5,431.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="186" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 187px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน<br />จะ return response กลับไป</div></div></foreignObject><text x="93" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">7. ถ้าตรวจสอบสิทธิ์ (authorities) ผ่าน&lt;br&gt;จะ return response กลับไป</text></switch></g><path d="M 743 475 L 409.37 475" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 404.12 475 L 411.12 471.5 L 409.37 475 L 411.12 478.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(776.5,409.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="225" height="41" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 225px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">6. verify <font color="#0000ff">session_token</font> ด้วย public key จากนั้นเช็คสิทธิ์ (authorities) ตามข้อมูล <br /><font color="#0000ff">session_token</font> ที่ระบบ authen ส่งมาให้</div></div></foreignObject><text x="113" y="27" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 400 515 L 66.37 515" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 61.12 515 L 68.12 511.5 L 66.37 515 L 68.12 518.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(101.5,488.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="227" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 228px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">8. แปลง / forward response กลับไปหา user </div></div></foreignObject><text x="114" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">8. แปลง / forward response กลับไปหา user </text></switch></g><g transform="translate(853.5,528.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="124" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 8px">Copyright Pamarin © 2019-Present</font></div></div></foreignObject><text x="62" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(329.5,117.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="154" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 155px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><b><font style="font-size: 14px">Client/Resource Server</font></b></div></div></foreignObject><text x="77" y="13" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 479.08 155.14 C 477.94 154.98 477.07 154.02 477 152.86 L 477 142.86 C 477.24 141.86 478.07 141.12 479.08 141 L 492.75 141 C 493.82 141.05 494.74 141.8 495 142.86 L 495 152.86 C 494.91 153.94 494.07 154.81 493.01 154.93 L 490.85 154.93 C 489.99 155.71 489.26 156.62 488.7 157.63 C 488.41 158.35 488.36 159.14 488.56 159.88 L 490.47 162.79 L 489.22 164.58 L 488.42 165.42 L 488.42 166.65 C 489.01 167.19 489.66 167.66 490.36 168.06 L 490.4 169.11 L 489.57 169.7 C 489.35 169.97 489.27 170.32 489.36 170.65 L 489.32 172.62 L 488.42 172.76 C 488.43 173.6 488.11 174.41 487.52 175.01 C 486.94 175.61 486.14 175.95 485.31 175.95 C 484.46 176 483.64 175.7 483.02 175.11 C 482.4 174.53 482.04 173.72 482.02 172.86 L 482.02 155.14 Z M 483.44 173.04 C 483.59 173.57 483.88 173.9 484.18 173.9 C 484.49 173.9 484.77 173.57 484.93 173.04 L 484.93 156.3 C 484.77 155.77 484.49 155.44 484.18 155.44 C 483.88 155.44 483.59 155.77 483.44 156.3 Z M 486 146.9 C 487.15 146.9 488.08 145.95 488.08 144.79 C 488.1 144.22 487.89 143.67 487.49 143.26 C 487.1 142.85 486.56 142.61 486 142.61 C 485.44 142.61 484.9 142.85 484.51 143.26 C 484.11 143.67 483.9 144.22 483.92 144.79 C 483.92 145.95 484.85 146.9 486 146.9 Z" fill="#7d7d7d" stroke="none" pointer-events="none"/><g transform="translate(510.5,142.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="132" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 133px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">public key <br />(ไว้ verify session_token)</font></div></div></foreignObject><text x="66" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 822.08 152.64 C 820.94 152.48 820.07 151.52 820 150.36 L 820 140.36 C 820.24 139.36 821.07 138.62 822.08 138.5 L 835.75 138.5 C 836.82 138.55 837.74 139.3 838 140.36 L 838 150.36 C 837.91 151.44 837.07 152.31 836.01 152.43 L 833.85 152.43 C 832.99 153.21 832.26 154.12 831.7 155.13 C 831.41 155.85 831.36 156.64 831.56 157.38 L 833.47 160.29 L 832.22 162.08 L 831.42 162.92 L 831.42 164.15 C 832.01 164.69 832.66 165.16 833.36 165.56 L 833.4 166.61 L 832.57 167.2 C 832.35 167.47 832.27 167.82 832.36 168.15 L 832.32 170.12 L 831.42 170.26 C 831.43 171.1 831.11 171.91 830.52 172.51 C 829.94 173.11 829.14 173.45 828.31 173.45 C 827.46 173.5 826.64 173.2 826.02 172.61 C 825.4 172.03 825.04 171.22 825.02 170.36 L 825.02 152.64 Z M 826.44 170.54 C 826.59 171.07 826.88 171.4 827.18 171.4 C 827.49 171.4 827.77 171.07 827.93 170.54 L 827.93 153.8 C 827.77 153.27 827.49 152.94 827.18 152.94 C 826.88 152.94 826.59 153.27 826.44 153.8 Z M 829 144.4 C 830.15 144.4 831.08 143.45 831.08 142.29 C 831.1 141.72 830.89 141.17 830.49 140.76 C 830.1 140.35 829.56 140.11 829 140.11 C 828.44 140.11 827.9 140.35 827.51 140.76 C 827.11 141.17 826.9 141.72 826.92 142.29 C 826.92 143.45 827.85 144.4 829 144.4 Z" fill="#7d7d7d" stroke="none" pointer-events="none"/><g transform="translate(853.5,140.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="132" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 133px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">public key <br />(ไว้ verify session_token)</font></div></div></foreignObject><text x="66" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(1213.5,140.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="125" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 126px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font style="font-size: 12px">private key <br />(ไว้ sign session_token)</font></div></div></foreignObject><text x="63" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><image x="1175.5" y="140.5" width="23" height="38" xlink:href="https://www.draw.io/img/lib/mscae/Key.svg" pointer-events="none"/></g></svg>